<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>cbmimage: block access functions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">cbmimage
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('group__blockaccess.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">block access functions</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga3556ec1f9ca611d0a41ed822c9d7f436" id="r_ga3556ec1f9ca611d0a41ed822c9d7f436"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga3556ec1f9ca611d0a41ed822c9d7f436">cbmimage_i_adjust_relative_address</a> (<a class="el" href="group__cbmimage__image.html#ga5169ab6270433dcb80cb916b9f4f18c7">cbmimage_fileimage</a> *image, <a class="el" href="group__blockaddress.html#ga4beaaf8e2c9f869003821e925a6c8273">cbmimage_blockaddress</a> *block)</td></tr>
<tr class="separator:ga3556ec1f9ca611d0a41ed822c9d7f436"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6763b8f6699d4cb98df89e5ec60132fc" id="r_ga6763b8f6699d4cb98df89e5ec60132fc"><td class="memItemLeft" align="right" valign="top">uint8_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga6763b8f6699d4cb98df89e5ec60132fc">cbmimage_i_get_address_of_block</a> (<a class="el" href="group__cbmimage__image.html#ga5169ab6270433dcb80cb916b9f4f18c7">cbmimage_fileimage</a> *image, <a class="el" href="group__blockaddress.html#ga4beaaf8e2c9f869003821e925a6c8273">cbmimage_blockaddress</a> block)</td></tr>
<tr class="separator:ga6763b8f6699d4cb98df89e5ec60132fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac7c1a0ef24fc6e6259ef3270a48650a1" id="r_gac7c1a0ef24fc6e6259ef3270a48650a1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gac7c1a0ef24fc6e6259ef3270a48650a1">cbmimage_read_block</a> (<a class="el" href="group__cbmimage__image.html#ga5169ab6270433dcb80cb916b9f4f18c7">cbmimage_fileimage</a> *image, <a class="el" href="group__blockaddress.html#ga4beaaf8e2c9f869003821e925a6c8273">cbmimage_blockaddress</a> block, void *buffer, size_t buffersize)</td></tr>
<tr class="memdesc:gac7c1a0ef24fc6e6259ef3270a48650a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">read a block from the image and copy it into the provided buffer  <br /></td></tr>
<tr class="separator:gac7c1a0ef24fc6e6259ef3270a48650a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab1d5af63333d0d0388f651409938d73c" id="r_gab1d5af63333d0d0388f651409938d73c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gab1d5af63333d0d0388f651409938d73c">cbmimage_write_block</a> (<a class="el" href="group__cbmimage__image.html#ga5169ab6270433dcb80cb916b9f4f18c7">cbmimage_fileimage</a> *image, <a class="el" href="group__blockaddress.html#ga4beaaf8e2c9f869003821e925a6c8273">cbmimage_blockaddress</a> block, void *buffer, size_t buffersize)</td></tr>
<tr class="memdesc:gab1d5af63333d0d0388f651409938d73c"><td class="mdescLeft">&#160;</td><td class="mdescRight">write a block to the image by copying it from the provided buffer  <br /></td></tr>
<tr class="separator:gab1d5af63333d0d0388f651409938d73c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab86747d99cc6c8e1e748557077439f05" id="r_gab86747d99cc6c8e1e748557077439f05"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gab86747d99cc6c8e1e748557077439f05">cbmimage_read_next_block</a> (<a class="el" href="group__cbmimage__image.html#ga5169ab6270433dcb80cb916b9f4f18c7">cbmimage_fileimage</a> *image, <a class="el" href="group__blockaddress.html#ga4beaaf8e2c9f869003821e925a6c8273">cbmimage_blockaddress</a> *block, void *buffer, size_t buffersize)</td></tr>
<tr class="memdesc:gab86747d99cc6c8e1e748557077439f05"><td class="mdescLeft">&#160;</td><td class="mdescRight">read the next block from the image and copy it into the provided buffer  <br /></td></tr>
<tr class="separator:gab86747d99cc6c8e1e748557077439f05"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga3556ec1f9ca611d0a41ed822c9d7f436" name="ga3556ec1f9ca611d0a41ed822c9d7f436"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3556ec1f9ca611d0a41ed822c9d7f436">&#9670;&#160;</a></span>cbmimage_i_adjust_relative_address()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int cbmimage_i_adjust_relative_address </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__cbmimage__image.html#ga5169ab6270433dcb80cb916b9f4f18c7">cbmimage_fileimage</a> *</td>          <td class="paramname"><span class="paramname"><em>image</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__blockaddress.html#ga4beaaf8e2c9f869003821e925a6c8273">cbmimage_blockaddress</a> *</td>          <td class="paramname"><span class="paramname"><em>block</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>adjust a relative address to a global address</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">image</td><td>pointer to the image data</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td>pointer to the block address for the block that is of interest</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>0 if the block lies in the current subdir</li>
<li>-1 if an error occurred </li>
</ul>
</dd></dl>

</div>
</div>
<a id="ga6763b8f6699d4cb98df89e5ec60132fc" name="ga6763b8f6699d4cb98df89e5ec60132fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6763b8f6699d4cb98df89e5ec60132fc">&#9670;&#160;</a></span>cbmimage_i_get_address_of_block()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t * cbmimage_i_get_address_of_block </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__cbmimage__image.html#ga5169ab6270433dcb80cb916b9f4f18c7">cbmimage_fileimage</a> *</td>          <td class="paramname"><span class="paramname"><em>image</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__blockaddress.html#ga4beaaf8e2c9f869003821e925a6c8273">cbmimage_blockaddress</a></td>          <td class="paramname"><span class="paramname"><em>block</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>get the address of a block</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">image</td><td>pointer to the image data</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td>pointer to the block address for the block that is of interest</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to the beginning of the block inside of the image memory</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd><ul>
<li>This function is for internal purposes only. <br  />
 Do not access from outside of the library, as it is subject to change!</li>
</ul>
</dd></dl>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000003">Bug</a></b></dt><dd><ul>
<li>There is no error checking on the provided block. <br  />
 That is, if the block does not exist, this function will happily provide an undefined pointer! </li>
</ul>
</dd></dl>

</div>
</div>
<a id="gac7c1a0ef24fc6e6259ef3270a48650a1" name="gac7c1a0ef24fc6e6259ef3270a48650a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac7c1a0ef24fc6e6259ef3270a48650a1">&#9670;&#160;</a></span>cbmimage_read_block()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cbmimage_read_block </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__cbmimage__image.html#ga5169ab6270433dcb80cb916b9f4f18c7">cbmimage_fileimage</a> *</td>          <td class="paramname"><span class="paramname"><em>image</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__blockaddress.html#ga4beaaf8e2c9f869003821e925a6c8273">cbmimage_blockaddress</a></td>          <td class="paramname"><span class="paramname"><em>block</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>buffer</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>buffersize</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>read a block from the image and copy it into the provided buffer </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">image</td><td>pointer to the image data</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td>pointer to the block address for the block that is of interest</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buffer</td><td>pointer to the buffer that will contain the block contents on termination</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buffersize</td><td>the size of the buffer pointed to by the parameter buffer</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>0 if the block is available and full (that is, it contains another link, so all byte are relevant)</li>
<li>&gt; 0: this is the last block, the return gives the number of valid byte in this block. For example, if the link of this last block is (0,x), it will return the value x.</li>
<li>-1 if an error occurred</li>
</ul>
</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd><ul>
<li>If the buffersize is not big enough, that is, it is not at least <a class="el" href="group__cbmimage__image.html#gae3525c085e57342ff54d326bbd220c3e" title="get the number of blocks in a block of the image">cbmimage_get_bytes_in_block()</a> byte long, this function does nothing. It does not even provide a partial copy of the data in this case! </li>
</ul>
</dd></dl>

</div>
</div>
<a id="gab86747d99cc6c8e1e748557077439f05" name="gab86747d99cc6c8e1e748557077439f05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab86747d99cc6c8e1e748557077439f05">&#9670;&#160;</a></span>cbmimage_read_next_block()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cbmimage_read_next_block </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__cbmimage__image.html#ga5169ab6270433dcb80cb916b9f4f18c7">cbmimage_fileimage</a> *</td>          <td class="paramname"><span class="paramname"><em>image</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__blockaddress.html#ga4beaaf8e2c9f869003821e925a6c8273">cbmimage_blockaddress</a> *</td>          <td class="paramname"><span class="paramname"><em>block</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>buffer</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>buffersize</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>read the next block from the image and copy it into the provided buffer </p>
<p>The next block is the next one according to the chain at the beginning of the block.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">image</td><td>pointer to the image data</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">block</td><td>pointer to the block address that will get the block address that has been read on termination</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">buffer</td><td>pointer to the buffer that has the link address, and that will contain the contents of the new block on termination</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buffersize</td><td>the size of the buffer pointed to by the parameter buffer</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>0 if the next block is available and full (that is, it contains another link, so all byte are relevant)</li>
<li>&gt; 0: this is the last block, the return gives the number of valid byte in this block. For example, if the link of this last block is (0,x), it will return the value x.</li>
<li>-1 if an error occurred, for example, there is no next block</li>
</ul>
</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd><ul>
<li>If the buffersize is not big enough, that is, it is not at least <a class="el" href="group__cbmimage__image.html#gae3525c085e57342ff54d326bbd220c3e" title="get the number of blocks in a block of the image">cbmimage_get_bytes_in_block()</a> byte long, this function does nothing. It does not even provide a partial copy of the data in this case!</li>
<li>If you want to read all the blocks of a file, call this function repeatedly until you get a -1 as return value.</li>
</ul>
</dd></dl>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000004">Bug</a></b></dt><dd><ul>
<li>There is no error checking on the provided link in the block. <br  />
 That is, if the linked to block does not exist, this function will happily provide an undefined pointer! </li>
</ul>
</dd></dl>

</div>
</div>
<a id="gab1d5af63333d0d0388f651409938d73c" name="gab1d5af63333d0d0388f651409938d73c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab1d5af63333d0d0388f651409938d73c">&#9670;&#160;</a></span>cbmimage_write_block()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cbmimage_write_block </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__cbmimage__image.html#ga5169ab6270433dcb80cb916b9f4f18c7">cbmimage_fileimage</a> *</td>          <td class="paramname"><span class="paramname"><em>image</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__blockaddress.html#ga4beaaf8e2c9f869003821e925a6c8273">cbmimage_blockaddress</a></td>          <td class="paramname"><span class="paramname"><em>block</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>buffer</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>buffersize</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>write a block to the image by copying it from the provided buffer </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">image</td><td>pointer to the image data</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td>pointer to the block address for the block that is of interest</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buffer</td><td>pointer to the buffer that has the contents that are to be written into the image</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buffersize</td><td>the size of the buffer pointed to by the parameter buffer</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>0 if the block is available</li>
<li>-1 if an error occurred</li>
</ul>
</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd><ul>
<li>If the buffersize is not big enough, that is, it is not at least <a class="el" href="group__cbmimage__image.html#gae3525c085e57342ff54d326bbd220c3e" title="get the number of blocks in a block of the image">cbmimage_get_bytes_in_block()</a> byte long, this function does nothing. It does not even partially copy the data in this case! </li>
</ul>
</dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
